-- TYPE TABLE 수정 쿼리

DROP TABLE "TYPE";

CREATE TABLE "TYPE" (
	"TYPE_CODE"	VARCHAR2(20)		NOT NULL,
	"TYPE_NAME"	VARCHAR2(30)		NULL,
	"TYPE_OPTION" NUMBER NOT NULL
);

INSERT INTO TYPE VALUES('TSHIRTS', '반팔티', 1);
INSERT INTO TYPE VALUES('MANTOMAN', '맨투맨', 1);
INSERT INTO TYPE VALUES('HOOD', '후드티', 1);
INSERT INTO TYPE VALUES('KNIT', '니트', 1);
INSERT INTO TYPE VALUES('CARDIGAN', '가디건', 1);
INSERT INTO TYPE VALUES('PADDING', '패딩', 1);
INSERT INTO TYPE VALUES('JACKET', '자켓', 1);
INSERT INTO TYPE VALUES('BLOUSE', '원피스', 1);
INSERT INTO TYPE VALUES('COTTON', '면바지', 2);
INSERT INTO TYPE VALUES('JEAN', '청바지', 2);
INSERT INTO TYPE VALUES('SSKIRT', '짧은치마', 2);
INSERT INTO TYPE VALUES('LSKIRT', '긴치마', 2);
INSERT INTO TYPE VALUES('CAP', '모자', 3);
INSERT INTO TYPE VALUES('SCARF', '목도리', 3);
INSERT INTO TYPE VALUES('SNEAKERS', '스니커즈', 3);
INSERT INTO TYPE VALUES('DRESSSHOES', '구두', 3);
INSERT INTO TYPE VALUES('SANDAL', '샌들', 3);

COMMENT ON COLUMN TYPE.TYPE_CODE IS '타입코드';
COMMENT ON COLUMN TYPE.TYPE_NAME IS '타입이름';
COMMENT ON COLUMN TYPE.TYPE_OPTION IS '타입분류';

ALTER TABLE "TYPE" ADD CONSTRAINT "PK_TYPE" PRIMARY KEY (
	"TYPE_CODE"
);

-- CLOSET TABLE 수정 쿼리

DROP TABLE "CLOSET";

DROP SEQUENCE SEQ_CLOTH;

CREATE TABLE "CLOSET" (
	"CLOTH_NO"	NUMBER NOT NULL,
	"MEMBER_NO"	NUMBER		NOT NULL,
    "TYPE_CODE"	VARCHAR2(20)		NOT NULL,
    "STYLE_CODE" VARCHAR2(30) NOT NULL,
    "COLOUR_CODE"	VARCHAR2(30)		NOT NULL,
	"FIT_CODE"	VARCHAR2(10)		NOT NULL,
	"SEASON_CODE"	VARCHAR2(10)		NOT NULL,
	"CLOTH_NAME"	VARCHAR2(100)		NULL,
	"CLOTH_BUYDATE"	DATE		NULL,
	"CLOTH_MEMO"	VARCHAR2(200)		NULL,
	"CLOTH_STATUS"	VARCHAR2(10)	DEFAULT 'Y' 	NULL,
    "LIKE_STATUS" VARCHAR2(3) DEFAULT 'N',
    "CHANGE_DATE" DATE DEFAULT SYSDATE
);

CREATE SEQUENCE SEQ_CLOTH;

INSERT INTO CLOSET VALUES(SEQ_CLOTH.NEXTVAL, 3, 'HOOD', '1,2', '255,255,255', 'SLIM', 'SF', '지오다노', '2019-10-01', '첫옷', DEFAULT, DEFAULT, '2019-10-01');
INSERT INTO CLOSET VALUES(SEQ_CLOTH.NEXTVAL, 3, 'PADDING', '3,6', '10,10,10', 'BASIC', 'SF', '탑텐', '2019-10-02', '둘옷', DEFAULT, DEFAULT, '2019-10-02');
INSERT INTO CLOSET VALUES(SEQ_CLOTH.NEXTVAL, 3, 'HOOD', '1,7', '15,15,15', 'SLIM', 'SF', '지오다노', '2019-10-03', '3옷', DEFAULT, 'Y', '2019-10-03');
INSERT INTO CLOSET VALUES(SEQ_CLOTH.NEXTVAL, 3, 'HOOD', '1,10', '25,25,25', 'OVERFIT', 'SF', '구찌', '2019-10-04', '4옷', DEFAULT, DEFAULT, '2019-10-04');
INSERT INTO CLOSET VALUES(SEQ_CLOTH.NEXTVAL, 2, 'PADDING', '3,6', '10,10,10', 'BASIC', 'SF', '탑텐', '2019-10-02', '둘옷', DEFAULT, DEFAULT, '2019-10-02');
INSERT INTO CLOSET VALUES(SEQ_CLOTH.NEXTVAL, 2, 'HOOD', '5,7', '15,15,15', 'SLIM', 'SF', '지오다노', '2019-10-03', '3옷', DEFAULT, DEFAULT, '2019-10-03');
INSERT INTO CLOSET VALUES(SEQ_CLOTH.NEXTVAL, 2, 'HOOD', '1,10', '25,25,25', 'OVERFIT', 'SF', '구찌', '2019-10-04', '4옷', DEFAULT, 'Y', '2019-10-04');
INSERT INTO CLOSET VALUES(SEQ_CLOTH.NEXTVAL, 3, 'HOOD', '1,14', '35,35,35', 'SLIM', 'WI', '무지', '2019-10-05', '5옷', DEFAULT, DEFAULT, '2019-10-05');
INSERT INTO CLOSET VALUES(SEQ_CLOTH.NEXTVAL, 3, 'HOOD', '1,3', '50,50,50', 'SLIM', 'SU', '지오다노', '2019-10-06', '6옷', DEFAULT, DEFAULT, '2019-10-06');
INSERT INTO CLOSET VALUES(SEQ_CLOTH.NEXTVAL, 3, 'HOOD', '6,7', '100,100,100', 'SLIM', 'SF', '무신사', '2019-10-07', '7옷', DEFAULT, DEFAULT, '2019-10-07');
INSERT INTO CLOSET VALUES(SEQ_CLOTH.NEXTVAL, 3, 'HOOD', '1,3', '110,0,110', 'SLIM', 'SF', '지오다노', '2019-10-08', '8옷', DEFAULT, 'Y', '2019-10-08');
INSERT INTO CLOSET VALUES(SEQ_CLOTH.NEXTVAL, 3, 'HOOD', '1,3', '255,0,255', 'SLIM', 'SF', '지오다노', '2019-10-09', '9옷', 'N', DEFAULT, '2019-10-09');
INSERT INTO CLOSET VALUES(SEQ_CLOTH.NEXTVAL, 3, 'HOOD', '1,3', '255,255,0', 'SLIM', 'SF', '지오다노', '2019-10-10', '10옷', DEFAULT, DEFAULT, '2019-10-10');
INSERT INTO CLOSET VALUES(SEQ_CLOTH.NEXTVAL, 3, 'JEAN', '1,3', '255,255,255', 'SLIM', 'SF', '지오다노', '2019-10-01', '첫옷', DEFAULT, DEFAULT, '2019-10-01');
INSERT INTO CLOSET VALUES(SEQ_CLOTH.NEXTVAL, 3, 'LSKIRT', '1,6', '10,10,10', 'BASIC', 'SF', '탑텐', '2019-10-02', '둘옷', DEFAULT, DEFAULT, '2019-10-02');
INSERT INTO CLOSET VALUES(SEQ_CLOTH.NEXTVAL, 3, 'SSKIRT', '1,7', '15,15,15', 'SLIM', 'SF', '지오다노', '2019-10-03', '3옷', DEFAULT, DEFAULT, '2019-10-03');
INSERT INTO CLOSET VALUES(SEQ_CLOTH.NEXTVAL, 3, 'COTTON', '1,10', '25,25,25', 'OVERFIT', 'SF', '구찌', '2019-10-04', '4옷', DEFAULT, 'Y', '2019-10-04');
INSERT INTO CLOSET VALUES(SEQ_CLOTH.NEXTVAL, 2, 'JEAN', '1,3', '10,10,10', 'BASIC', 'SF', '탑텐', '2019-10-02', '둘옷', DEFAULT, DEFAULT, '2019-10-02');
INSERT INTO CLOSET VALUES(SEQ_CLOTH.NEXTVAL, 2, 'JEAN', '1,7', '15,15,15', 'SLIM', 'SF', '지오다노', '2019-10-03', '3옷', DEFAULT, DEFAULT, '2019-10-03');
INSERT INTO CLOSET VALUES(SEQ_CLOTH.NEXTVAL, 2, 'JEAN', '1,10', '25,25,25', 'OVERFIT', 'SF', '구찌', '2019-10-04', '4옷', DEFAULT, DEFAULT, '2019-10-04');
INSERT INTO CLOSET VALUES(SEQ_CLOTH.NEXTVAL, 3, 'JEAN', '2,14', '35,35,35', 'SLIM', 'WI', '무지', '2019-10-05', '5옷', DEFAULT, DEFAULT, '2019-10-05');
INSERT INTO CLOSET VALUES(SEQ_CLOTH.NEXTVAL, 3, 'JEAN', '3,13', '50,50,50', 'SLIM', 'SU', '지오다노', '2019-10-06', '6옷', DEFAULT, DEFAULT, '2019-10-06');
INSERT INTO CLOSET VALUES(SEQ_CLOTH.NEXTVAL, 3, 'JEAN', '2,7', '100,100,100', 'SLIM', 'SF', '무신사', '2019-10-07', '7옷', DEFAULT, DEFAULT, '2019-10-07');
INSERT INTO CLOSET VALUES(SEQ_CLOTH.NEXTVAL, 3, 'JEAN', '1,3', '110,0,110', 'SLIM', 'SF', '지오다노', '2019-10-08', '8옷', DEFAULT, DEFAULT, '2019-10-08');
INSERT INTO CLOSET VALUES(SEQ_CLOTH.NEXTVAL, 3, 'JEAN', '1,3', '255,0,255', 'SLIM', 'SF', '지오다노', '2019-10-09', '9옷', 'N', DEFAULT, '2019-10-09');
INSERT INTO CLOSET VALUES(SEQ_CLOTH.NEXTVAL, 3, 'JEAN', '1,3', '255,255,0', 'SLIM', 'SF', '지오다노', '2019-10-10', '10옷', DEFAULT, DEFAULT, '2019-10-10');
INSERT INTO CLOSET VALUES(SEQ_CLOTH.NEXTVAL, 3, 'SNEAKERS', '2,7', '100,100,100', 'SLIM', 'SF', '무신사', '2019-10-07', '7옷', DEFAULT, DEFAULT, '2019-10-07');
INSERT INTO CLOSET VALUES(SEQ_CLOTH.NEXTVAL, 3, 'SCARF', '1,3', '110,0,110', 'SLIM', 'SF', '지오다노', '2019-10-08', '8옷', DEFAULT, DEFAULT, '2019-10-08');
INSERT INTO CLOSET VALUES(SEQ_CLOTH.NEXTVAL, 3, 'CAP', '2,3', '255,0,255', 'SLIM', 'SF', '지오다노', '2019-10-09', '9옷', 'N', DEFAULT, '2019-10-09');
INSERT INTO CLOSET VALUES(SEQ_CLOTH.NEXTVAL, 3, 'CAP', '2,3', '255,255,0', 'SLIM', 'SF', '지오다노', '2019-10-10', '10옷', DEFAULT, 'Y', '2019-10-10');

COMMENT ON COLUMN CLOSET.CLOTH_NO IS '옷번호';
COMMENT ON COLUMN CLOSET.MEMBER_NO IS '회원번호';
COMMENT ON COLUMN CLOSET.TYPE_CODE IS '타입코드';
COMMENT ON COLUMN CLOSET.STYLE_CODE IS '스타일코드';
COMMENT ON COLUMN CLOSET.COLOUR_CODE IS '칼라코드';
COMMENT ON COLUMN CLOSET.FIT_CODE IS '핏코드';
COMMENT ON COLUMN CLOSET.SEASON_CODE IS '계절코드';
COMMENT ON COLUMN CLOSET.CLOTH_NAME IS '옷이름';
COMMENT ON COLUMN CLOSET.CLOTH_BUYDATE IS '옷구매일자';
COMMENT ON COLUMN CLOSET.CLOTH_MEMO IS '옷장메모';
COMMENT ON COLUMN CLOSET.CLOTH_STATUS IS '옷삭제여부';
COMMENT ON COLUMN CLOSET.LIKE_STATUS IS '선호여부';
COMMENT ON COLUMN CLOSET.CHANGE_DATE IS '최종수정일';

ALTER TABLE "CLOSET" ADD CONSTRAINT "PK_CLOSET" PRIMARY KEY (
	"CLOTH_NO"
);

-- MYCLOSET VIEW 생성 쿼리

CREATE OR REPLACE VIEW MYCLOSET
AS SELECT ROW_NUMBER() OVER(PARTITION BY MEMBER_NO ORDER BY TYPE_OPTION ASC, CLOTH_BUYDATE DESC) CNUM, A.*
FROM(SELECT CLOTH_NO, MEMBER_NO, TYPE_CODE, TYPE_OPTION, STYLE_CODE, COLOUR_CODE, FIT_CODE, SEASON_CODE, CLOTH_NAME, CLOTH_BUYDATE, CLOTH_MEMO, CLOTH_STATUS, LIKE_STATUS, CHANGE_DATE
FROM CLOSET
JOIN TYPE USING(TYPE_CODE)
WHERE CLOTH_STATUS = 'Y'
ORDER BY CLOTH_NO DESC)A;

-- MYBLIST VIEW 생성 쿼리

CREATE OR REPLACE VIEW MYBLIST
AS SELECT ROW_NUMBER() OVER(PARTITION BY MEMBER_NO ORDER BY MEMBER_NO, ARTICLE_NO DESC) NUM, A.*
FROM(SELECT ARTICLE_NO, MEMBER_NO, MEMBER_NICK, ARTICLE_VIEWS, ARTICLE_WISHES, ARTICLE_URL, ARTICLE_CONTENTS, ARTICLE_DATE, ARTICLE_STATUS
FROM BOARD
JOIN MEMBER USING (MEMBER_NO)
WHERE ARTICLE_STATUS='Y'
ORDER BY ARTICLE_NO DESC)A;

-- MYQNALIST VIEW 생성 쿼리

CREATE OR REPLACE VIEW MYQNALIST
AS SELECT ROW_NUMBER() OVER(PARTITION BY MEMBER_NO ORDER BY MEMBER_NO, QNA_NO DESC) NUM, A.*
FROM(SELECT QNA_NO, MEMBER_NO, MEMBER_NICK, ENROLL_DATE, QNA_TITLE, QNA_CONTENTS, ANSWER_STATUS, ANSWER_CONTENTS
FROM QNA
JOIN MEMBER USING (MEMBER_NO)
ORDER BY QNA_NO DESC)A;

-- QNA TABLE 수정 쿼리

ALTER TABLE QNA MODIFY (ENROLL_DATE DEFAULT SYSDATE);
ALTER TABLE QNA MODIFY (ANSWER_CONTENTS DEFAULT '미등록');

ALTER TABLE QNA
DROP CONSTRAINT PK_QNA;

ALTER TABLE QNA
ADD CONSTRAINT PK_QNA PRIMARY KEY(QNA_NO);

-- TYPE TABLE DATA 추가 쿼리

INSERT INTO TYPE VALUES('SHORT', '반바지', 2);